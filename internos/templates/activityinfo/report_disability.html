{% extends "base2.html" %}
{% load staticfiles i18n %}
{% load util_tags %}
{% load static %}


{% block content %}
<style>
.collapse-all.active, .expanded-all.active {
  color: #0089d2;
}
  svg {
    width: 100%;
  }

  path.slice{
    stroke-width:2px;
  }

  polyline{
    opacity: .3;
    stroke: black;
    stroke-width: 2px;
    fill: none;
  }
  .chart_top {
   width:100%;
   height:100%
  }

  g.x.axis g.tick text {
    text-anchor: end !important;
    font-size: 11px;
  }

</style>
<div class="app-main__inner">

   <div class="app-page-title">
    <div class="page-title-wrapper">
        <div class="page-title-heading" data-step="4" >

        </div>
      <div class="page-title-actions">
      </div>
    </div>
  </div>


  <div class="row">
    <div class="col-lg-12">
      <div class="main-card mb-3 card">
          <div class="card-header">

              <i class="header-icon fa fa-wheelchair icon-gradient  bg-malibu-beach" aria-hidden="true"></i>
          </i>
           {{ database.label }} | Disability Report  | {{ reporting_year }}
           </div>
        <div class="card-body">


           <div class="table-responsive mt-3">
                <table class="table  table-striped " id="#table-disability">
            <thead>
            <tr>
              <th class="w-150"> Indicator Name</th>
              {% for tag in tags_disability %}
              <th content="{{ tag.tag_disability__label }}" >{{ tag.tag_disability__label }}
              </th>
              {% endfor %}
            </tr>
            </thead>
            <tbody>
            {% for item in master_indicators %}
            {% get_indicator_cumulative item as cumulative_value %}
            <tr>
              <th>{{ item.name }}</th>
              {% for tag in tags_disability %}
              {% get_indicator_tag_value item tag.tag_disability__name as value %}
              <td>
                <div class="progress">
                  <div class="progress-bar" role="progressbar"
                       aria-valuenow="{{ value|percentage_float:item.cumulative_values.months }}" aria-valuemin="0"
                       aria-valuemax="100" style="{% if value != '0' %} width: 50%;{% endif %}">
                    {{ value }}
                  </div>
                </div>
              </td>
              {% endfor %}
            </tr>
            {% endfor %}
            </tbody>
          </table>
           </div>


         </div>
       </div>

<!--      <div class="main-card mb-3 card">-->
<!--         <div class="card-body">-->
<!--           <h5 class="card-title">Disability types </h5>-->
<!--        <div class="chart_top">-->
<!--          <div id="chart-1"></div>-->
<!--        </div>-->
<!--         </div>-->
<!--       </div>-->

<!--       <div class="main-card mb-3 card">-->
<!--         <div class="card-body">-->
<!--           <h5 class="card-title">Disability types by Partner  </h5>-->
<!--          <div id="chart-2"></div>-->
<!--        </div>-->
<!--       </div>-->

<!--     <div class="main-card mb-3 card">-->
<!--         <div class="card-body">-->
<!--           <h5 class="card-title">  Disability types by Governorate</h5>-->
<!--          <div id="chart-3"></div>-->
<!--        </div>-->
<!--     </div>-->



    </div>


  </div>

</div>

{% endblock content %}

{% block extra_js %}
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.10/dist/css/bootstrap-select.min.css">

<!-- Latest compiled and minified JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.10/dist/js/bootstrap-select.min.js"></script>

<script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
<script type="text/javascript" src="{% static 'js/d3.chart.js' %}"></script>

<script>

var range = ["#31B6FD", "#F5C040", "#A5D027", "#5BCF78", "#4584D3"];

    // Disabilities
    var data1 = '{{ disability_values|safe }}';
    data1 = JSON.parse(data1);
    var domain1 = '{{ disability_keys|safe }}';
    domain1 = JSON.parse(domain1)
    d3ChartPie(data1, '#chart-1', domain1, range, 250, 150);

    var data2 = '{{ disability_per_partner|safe }}';
    var data2 = JSON.parse(data2);
    var domain2 = '{{ disability_partners|safe }}';
    domain2 = JSON.parse(domain2);
    d3ChartBar(data2, '#chart-2', domain1, domain2, range);

    var data3 = '{{ disability_per_gov|safe }}';
    var data3 = JSON.parse(data3);
    var domain3 = '{{ disability_govs|safe }}';
    domain3 = JSON.parse(domain3);
    d3ChartBar(data3, '#chart-3', domain1, domain3, range);

</script>


<script>
  var getUrlParameter = function getUrlParameter(sParam) {
    var sPageURL = window.location.search.substring(1),
        sURLVariables = sPageURL.split('&'),
        sParameterName,
        i;

    for (i = 0; i < sURLVariables.length; i++) {
        sParameterName = sURLVariables[i].split('=');

        if (sParameterName[0] === sParam) {
            return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
        }
    }
};
  $(document).ready(function () {

    var id = getUrlParameter('ai_id');
    var selected_li=$('li#'+id).find('a');
    var parent = selected_li.parent();
    parent.addClass("mm-active");
    selected_li.addClass("mm-active");
});
</script>

{% endblock %}
